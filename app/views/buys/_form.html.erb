<%= f.collection_select :site_id, Site.all, :id, :name, :include_blank => true, :label => "Site" %>

<% if %w(new create).include?(@controller.action_name) %>
  <fieldset>
    <legend>or create a new Site</legend>
    <% f.fields_for(:site, f.object.build_site) do |s| %>
      <%= render :partial => "sites/form", :locals => { :f => s } %>
    <% end %>
  </fieldset>
<% end %>

<h2>Placements</h2>
<ul>
  <% f.fields_for(:placements) do |p| %>
  <li>
    <fieldset>
      <legend>
        <% if p.object.new_record? %>
        Create Placement
        <% else %>
        Update Placement
        <% end %>
      </legend>
      <%= render :partial => "placements/form", :locals => { :f => p } %>
    </fieldset>
  </li>
  <% end %>
  
  <!-- build new placement -->
  <% f.fields_for(:placements, f.object.placements.build) do |p| %>
  <li>
    <fieldset>
      <legend>
        <% if p.object.new_record? %>
        Create Placement
        <% else %>
        Update Placement
        <% end %>
      </legend>
      <%= render :partial => "placements/form", :locals => { :f => p } %>
      <%= link_to_remote "Add New Placement", :url => { :action => "add_placement" }, :with => "form_contents()" %>
    </fieldset>
  </li>
  <% end %>
</ul>
